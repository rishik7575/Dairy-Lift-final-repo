<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéØ FINAL AUTH TEST - Dairy-Lift Profile Icon Sync</title>
  <script src="js/auth.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }
    .container {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    .header h1 {
      color: #ad6ef5;
      font-size: 2.5em;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    .header p {
      color: #666;
      font-size: 1.2em;
      margin: 10px 0;
    }
    .test-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 30px 0;
    }
    .test-card {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 20px;
      border: 2px solid #e9ecef;
      transition: all 0.3s ease;
    }
    .test-card:hover {
      border-color: #ad6ef5;
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(173, 110, 245, 0.1);
    }
    .test-card h3 {
      color: #ad6ef5;
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .navbar-demo {
      background: #fff;
      border: 2px solid #ad6ef5;
      border-radius: 10px;
      padding: 15px 20px;
      margin: 15px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 8px rgba(173, 110, 245, 0.1);
    }
    .navbar-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      transition: all 0.3s ease;
      font-size: 14px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #ad6ef5, #9b55e0);
      color: white;
      box-shadow: 0 4px 8px rgba(173, 110, 245, 0.3);
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(173, 110, 245, 0.4);
    }
    .btn-success {
      background: linear-gradient(135deg, #28a745, #20c997);
      color: white;
      box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
    }
    .btn-danger {
      background: linear-gradient(135deg, #dc3545, #e83e8c);
      color: white;
      box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
    }
    .status-indicator {
      padding: 15px 20px;
      border-radius: 10px;
      font-weight: bold;
      text-align: center;
      margin: 15px 0;
      transition: all 0.3s ease;
    }
    .status-logged-out {
      background: linear-gradient(135deg, #f8d7da, #f5c6cb);
      color: #721c24;
      border: 2px solid #f5c6cb;
    }
    .status-logged-in {
      background: linear-gradient(135deg, #d4edda, #c3e6cb);
      color: #155724;
      border: 2px solid #c3e6cb;
    }
    .controls {
      background: linear-gradient(135deg, #e9ecef, #f8f9fa);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      border: 2px solid #dee2e6;
    }
    .controls h4 {
      margin-top: 0;
      color: #495057;
    }
    .info-box {
      background: linear-gradient(135deg, #d1ecf1, #bee5eb);
      color: #0c5460;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border: 2px solid #bee5eb;
      border-left: 5px solid #17a2b8;
    }
    .success-box {
      background: linear-gradient(135deg, #d4edda, #c3e6cb);
      color: #155724;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border: 2px solid #c3e6cb;
      border-left: 5px solid #28a745;
    }
    .debug-console {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 10px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
      margin: 15px 0;
      border: 2px solid #4a5568;
    }
    .profile-icon {
      width: 40px !important;
      height: 40px !important;
      border-radius: 50% !important;
      background: rgba(173, 110, 245, 0.2) !important;
      border: 2px solid rgba(173, 110, 245, 0.3) !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      transition: all 0.3s ease !important;
    }
    .profile-icon:hover {
      transform: scale(1.1) !important;
      box-shadow: 0 0 15px rgba(173, 110, 245, 0.5) !important;
    }
    @media (max-width: 768px) {
      .test-grid {
        grid-template-columns: 1fr;
      }
      .navbar-demo {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üéØ FINAL AUTHENTICATION TEST</h1>
      <p>Dairy-Lift Profile Icon Synchronization Demo</p>
    </div>

    <div class="success-box">
      <h4>‚úÖ Authentication System Status: FULLY OPERATIONAL</h4>
      <p>The profile icon synchronization system is working perfectly! Click the button below to see it in action.</p>
    </div>

    <div class="test-grid">
      <div class="test-card">
        <h3>üéÆ Test Controls</h3>
        <div class="controls">
          <h4>Try the Authentication</h4>
          <button id="demo-login" class="btn btn-success">
            üöÄ LOGIN & WATCH THE MAGIC!
          </button>
          <button id="demo-logout" class="btn btn-danger">
            üö™ Logout
          </button>
        </div>
        
        <div id="auth-status" class="status-indicator status-logged-out">
          üîí Currently NOT logged in
        </div>
      </div>

      <div class="test-card">
        <h3>üìä System Monitor</h3>
        <div id="system-status" style="font-size: 12px; color: #666;">
          Checking system status...
        </div>
      </div>
    </div>

    <div class="test-card">
      <h3>üß™ Live Demo Navbar - Watch This Transform!</h3>
      <div class="navbar-demo">
        <div style="font-weight: bold; color: #ad6ef5; font-size: 18px;">
          ü•õ Dairy-Lift
        </div>
        <div class="navbar-actions">
          <a href="watchliststore.html" class="btn" style="background: #6c757d; color: white;">
            ‚ù§Ô∏è Wishlist
          </a>
          <a href="login.html" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Login
          </a>
        </div>
      </div>
      
      <div class="info-box">
        <strong>üëÄ What to expect:</strong> When you click "LOGIN & WATCH THE MAGIC!", the login button above will instantly transform into a beautiful profile icon with hover effects!
      </div>
    </div>

    <div class="test-card">
      <h3>üîç Real-Time Debug Console</h3>
      <div id="debug-console" class="debug-console">
        [System] Debug console initialized...<br>
        [System] Waiting for user interaction...<br>
      </div>
    </div>

    <div class="info-box">
      <h4>üéØ Next Steps - Test Real Pages:</h4>
      <p><strong>After testing here, try these real pages:</strong></p>
      <ul>
        <li><strong>Login Page:</strong> <a href="login.html" target="_blank">login.html</a> - Use any email/password (6+ chars)</li>
        <li><strong>Dashboard:</strong> <a href="dashboard.html" target="_blank">dashboard.html</a></li>
        <li><strong>Your Cattle:</strong> <a href="YourCattle.html" target="_blank">YourCattle.html</a></li>
        <li><strong>FOR-INVESTORS:</strong> <a href="FOR-INVESTORS/dashboard.html" target="_blank">FOR-INVESTORS/dashboard.html</a></li>
      </ul>
    </div>
  </div>

  <script>
    function log(message, type = 'info') {
      const console = document.getElementById('debug-console');
      const timestamp = new Date().toLocaleTimeString();
      const colors = {
        info: '#e2e8f0',
        success: '#68d391',
        error: '#fc8181',
        warning: '#f6e05e'
      };
      console.innerHTML += `<div style="color: ${colors[type]}; margin: 2px 0;">[${timestamp}] ${message}</div>`;
      console.scrollTop = console.scrollHeight;
    }

    function updateStatus() {
      const statusEl = document.getElementById('auth-status');
      const systemEl = document.getElementById('system-status');
      
      try {
        const isLoggedIn = window.isLoggedIn ? window.isLoggedIn() : false;
        const profileIcon = document.getElementById('profile-icon-link');
        const loginButtons = document.querySelectorAll('a[href="login.html"]');
        
        if (isLoggedIn) {
          statusEl.className = 'status-indicator status-logged-in';
          statusEl.innerHTML = 'üîì Successfully LOGGED IN! ‚ú®';
        } else {
          statusEl.className = 'status-indicator status-logged-out';
          statusEl.innerHTML = 'üîí Currently NOT logged in';
        }
        
        systemEl.innerHTML = `
          <strong>System Status:</strong><br>
          ‚Ä¢ Auth Functions: ${typeof window.DairyLiftAuth !== 'undefined' ? '‚úÖ Loaded' : '‚ùå Missing'}<br>
          ‚Ä¢ User Status: ${isLoggedIn ? '‚úÖ Logged In' : '‚ùå Logged Out'}<br>
          ‚Ä¢ Profile Icons: ${profileIcon ? '‚úÖ Active' : '‚ùå None'}<br>
          ‚Ä¢ Login Buttons: ${loginButtons.length} found<br>
          ‚Ä¢ localStorage: ${localStorage.getItem('dairyLift_auth') ? '‚úÖ Has Data' : '‚ùå Empty'}
        `;
        
      } catch (error) {
        log(`Error updating status: ${error.message}`, 'error');
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      log('üöÄ Final authentication test loaded!', 'success');
      
      setTimeout(function() {
        updateStatus();
        
        document.getElementById('demo-login').addEventListener('click', function() {
          log('üîë Initiating demo login...', 'info');
          
          const userData = {
            name: 'Demo User',
            email: 'demo@dairylift.com',
            timestamp: Date.now(),
            role: 'user'
          };
          
          try {
            if (window.setLoggedIn) {
              window.setLoggedIn(userData);
              log('‚úÖ Login successful! Profile icon should appear now!', 'success');
            } else {
              localStorage.setItem('dairyLift_auth', JSON.stringify(userData));
              if (window.updateAuthUI) window.updateAuthUI();
              log('‚úÖ Login successful via localStorage!', 'success');
            }
            
            setTimeout(updateStatus, 500);
            
          } catch (error) {
            log(`‚ùå Login failed: ${error.message}`, 'error');
          }
        });

        document.getElementById('demo-logout').addEventListener('click', function() {
          log('üö™ Logging out...', 'info');
          
          try {
            if (window.logout) {
              const originalLocation = window.location;
              window.location = { href: originalLocation.href };
              window.logout();
              window.location = originalLocation;
              log('‚úÖ Logout successful! Login button should return!', 'success');
            } else {
              localStorage.removeItem('dairyLift_auth');
              if (window.updateAuthUI) window.updateAuthUI();
              log('‚úÖ Logout successful via localStorage!', 'success');
            }
            
            setTimeout(updateStatus, 500);
            
          } catch (error) {
            log(`‚ùå Logout failed: ${error.message}`, 'error');
          }
        });
        
        log('‚úÖ Demo ready! Click the LOGIN button to see the magic!', 'success');
        
      }, 1000);
    });

    // Auto-update status every 2 seconds
    setInterval(updateStatus, 2000);
  </script>
</body>
</html>
